<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO Meta Tags -->
    <title>Crypto Position Size Calculator - Calculate Risk & Position Sizing | Free Tool</title>
    <meta name="description" content="Free crypto position size calculator for cryptocurrency traders. Calculate your trade size based on risk percentage or capped investment. Includes stop loss and take profit calculations with TP2 and TP3 targets. Works with all exchanges.">
    <meta name="keywords" content="crypto position size calculator, crypto risk management, position sizing tool, crypto trading calculator, stop loss calculator, take profit calculator, cryptocurrency calculator, trading risk management, binance calculator, bybit calculator, kraken calculator">
    <meta name="author" content="Crypto Position Calculator">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://yourdomain.com/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourdomain.com/">
    <meta property="og:title" content="Free Crypto Position Size Calculator">
    <meta property="og:description" content="Calculate your crypto trade size with precision. Free tool for traders with risk management, stop loss, and take profit calculations. Works with all exchanges.">
    <meta property="og:image" content="https://yourdomain.com/preview.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://yourdomain.com/">
    <meta property="twitter:title" content="Free Crypto Position Size Calculator">
    <meta property="twitter:description" content="Calculate your crypto trade size with precision. Free tool for traders with risk management, stop loss, and take profit calculations. Works with all exchanges.">
    <meta property="twitter:image" content="https://yourdomain.com/preview.jpg">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">

    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .input-modern {
            transition: all 0.3s ease;
        }

        .input-modern:focus {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .btn-modern {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .btn-modern:active {
            transform: translateY(0);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-slide-in {
            animation: slideIn 0.4s ease-out;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen py-8 px-4">
    <div class="container mx-auto max-w-4xl">
        <!-- Header -->
        <div class="text-center mb-6 animate-slide-in">
            <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-2 drop-shadow-lg">
                Crypto Position Size Calculator
            </h1>
            <p class="text-white text-opacity-90 text-base">Calculate risk & position sizing for your crypto trades</p>
            <div class="inline-block mt-2 px-4 py-1.5 bg-green-400 bg-opacity-90 rounded-full">
                <p class="text-gray-900 text-sm font-bold">All crypto pairs â€¢ Bybit prices available</p>
            </div>
        </div>

        <!-- Main Content -->
        <main>
            <div x-data="positionCalculator()" x-init="init()" class="glass-card rounded-2xl shadow-2xl p-6 md:p-8 animate-slide-in">

            <!-- Loading State -->
            <div x-show="loading" class="text-center py-12">
                <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-4 border-purple-600"></div>
                <p class="mt-4 text-gray-600 font-medium">Loading Bybit pairs...</p>
            </div>

            <!-- Main Form -->
            <div x-show="!loading">
                <!-- Top Section: Capital and Mode -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-5">
                    <!-- Total Capital -->
                    <div>
                        <label class="block text-gray-800 font-bold mb-2 text-xs uppercase tracking-wider">Total Capital</label>
                        <div class="relative">
                            <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                            <input
                                type="number"
                                x-model.number="totalCapital"
                                @input="calculate(); saveToLocalStorage()"
                                class="w-full pl-7 pr-3 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all input-modern font-semibold"
                                placeholder="10000"
                            >
                        </div>
                    </div>

                    <!-- Calculation Mode Toggle -->
                    <div>
                        <label class="block text-gray-800 font-bold mb-2 text-xs uppercase tracking-wider">Calculation Mode</label>
                        <div class="grid grid-cols-2 gap-2 bg-gray-100 p-1.5 rounded-lg">
                            <button
                                @click="calculationMode = 'risk'; calculate(); saveToLocalStorage()"
                                :class="calculationMode === 'risk' ? 'bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg scale-105' : 'bg-white text-gray-700 hover:bg-gray-50'"
                                class="px-3 py-2.5 rounded-md font-bold transition-all btn-modern text-sm"
                            >
                                Risk %
                            </button>
                            <button
                                @click="calculationMode = 'capped'; calculate(); saveToLocalStorage()"
                                :class="calculationMode === 'capped' ? 'bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg scale-105' : 'bg-white text-gray-700 hover:bg-gray-50'"
                                class="px-3 py-2.5 rounded-md font-bold transition-all btn-modern text-sm"
                            >
                                Capped $
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Risk Percentage Input (Risk Mode) -->
                <div x-show="calculationMode === 'risk'" class="mb-5">
                    <label class="block text-gray-800 font-bold mb-2 text-xs uppercase tracking-wider">Risk Percentage</label>
                    <div class="relative">
                        <input
                            type="number"
                            x-model.number="riskPercentage"
                            @input="calculate(); saveToLocalStorage()"
                            step="0.1"
                            class="w-full px-3 py-3 pr-9 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all input-modern font-semibold"
                            placeholder="2.0"
                        >
                        <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">%</span>
                    </div>
                </div>

                <!-- Max Investment Input (Capped Mode) -->
                <div x-show="calculationMode === 'capped'" class="mb-5">
                    <label class="block text-gray-800 font-bold mb-2 text-xs uppercase tracking-wider">Max Investment per Trade</label>
                    <div class="relative">
                        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                        <input
                            type="number"
                            x-model.number="maxInvestment"
                            @input="calculate(); saveToLocalStorage()"
                            class="w-full pl-7 pr-3 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all input-modern font-semibold"
                            placeholder="2500"
                        >
                    </div>
                </div>

                <!-- Crypto Pair Selection -->
                <div class="mb-5" x-data="{ isOpen: false }" @click.away="isOpen = false">
                    <label class="block text-gray-800 font-bold mb-2 text-xs uppercase tracking-wider">
                        Crypto Pair
                        <span class="text-gray-500 text-xs font-normal normal-case">(Optional - for auto price)</span>
                    </label>
                    <div class="relative">
                        <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <input
                            type="text"
                            x-model="searchQuery"
                            @input="filterPairs(); isOpen = true"
                            @focus="isOpen = true"
                            placeholder="Search Bybit pairs (optional) or enter price manually below..."
                            class="w-full pl-10 pr-3 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all input-modern font-semibold"
                        >

                        <!-- Dropdown List -->
                        <div
                            x-show="isOpen && filteredPairs.length > 0"
                            class="absolute z-20 w-full mt-1 bg-white border-2 border-purple-200 rounded-lg shadow-2xl max-h-60 overflow-y-auto"
                        >
                            <template x-for="pair in filteredPairs.slice(0, 50)" :key="pair">
                                <div
                                    @click="selectPair(pair); isOpen = false"
                                    class="px-4 py-2 hover:bg-purple-50 cursor-pointer transition-all border-b border-gray-100 last:border-b-0"
                                    :class="selectedPair === pair ? 'bg-purple-100 font-bold text-purple-700' : 'font-medium text-gray-700'"
                                    x-text="pair"
                                ></div>
                            </template>
                        </div>

                        <!-- No results message -->
                        <div
                            x-show="isOpen && searchQuery && filteredPairs.length === 0"
                            class="absolute z-20 w-full mt-1 bg-white border-2 border-gray-200 rounded-lg shadow-lg p-4 text-center text-gray-500"
                        >
                            No Bybit pairs found - enter price manually below
                        </div>
                    </div>
                </div>

                <!-- Price Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-5">
                    <!-- Current Price -->
                    <div class="lg:col-span-2">
                        <label class="block text-gray-800 font-bold mb-2 text-xs uppercase tracking-wider">Current Price</label>
                        <div class="flex gap-2">
                            <div class="relative flex-1">
                                <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                                <input
                                    type="number"
                                    x-model.number="currentPrice"
                                    @input="calculate()"
                                    step="0.00000001"
                                    class="w-full pl-7 pr-3 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all input-modern font-semibold"
                                    placeholder="0.00"
                                >
                            </div>
                            <button
                                @click="fetchCurrentPrice()"
                                :disabled="!selectedPair"
                                class="px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-bold hover:from-green-600 hover:to-emerald-700 disabled:from-gray-300 disabled:to-gray-400 disabled:cursor-not-allowed transition-all btn-modern shadow-lg disabled:shadow-none"
                            >
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                            </button>
                        </div>
                        <p x-show="priceLoading" class="text-xs text-purple-600 mt-1 font-medium">Fetching price...</p>
                    </div>

                    <!-- Stop Loss -->
                    <div>
                        <label class="block text-gray-800 font-bold mb-2 text-xs uppercase tracking-wider">Stop Loss</label>
                        <div class="relative">
                            <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                            <input
                                type="number"
                                x-model.number="stopLoss"
                                @input="calculate()"
                                step="0.00000001"
                                class="w-full pl-7 pr-3 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-all input-modern font-semibold"
                                placeholder="0.00"
                            >
                        </div>
                    </div>
                </div>

                <!-- Take Profit (Optional) -->
                <div class="mb-6">
                    <label class="block text-gray-800 font-bold mb-2 text-xs uppercase tracking-wider">
                        Take Profit
                        <span class="text-gray-500 text-xs font-normal normal-case">(Optional)</span>
                    </label>
                    <div class="relative">
                        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">$</span>
                        <input
                            type="number"
                            x-model.number="takeProfit"
                            @input="calculate()"
                            step="0.00000001"
                            class="w-full pl-7 pr-3 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all input-modern font-semibold"
                            placeholder="0.00"
                        >
                    </div>
                </div>

                <!-- Results Section -->
                <div x-show="results.coinsAmount !== null" class="border-t-2 border-gray-200 pt-5 animate-slide-in">
                    <div class="flex items-center gap-2 mb-4">
                        <div class="h-8 w-1 bg-gradient-to-b from-purple-600 to-indigo-600 rounded-full"></div>
                        <h2 class="text-2xl font-extrabold text-gray-800">Results</h2>
                    </div>

                    <!-- Position Details -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-4">
                        <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-xl card-hover border-2 border-blue-200 relative group">
                            <button
                                @click="copyToClipboard(results.coinsAmount?.toFixed(2), 'Coins to Buy')"
                                class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity p-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg"
                                title="Copy to clipboard"
                            >
                                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                            </button>
                            <p class="text-xs text-blue-700 font-bold uppercase tracking-wider mb-1">Coins to Buy</p>
                            <p class="text-2xl font-extrabold text-blue-700" x-text="results.coinsAmount?.toFixed(2)"></p>
                        </div>
                        <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-xl card-hover border-2 border-purple-200">
                            <p class="text-xs text-purple-700 font-bold uppercase tracking-wider mb-1">Investment Amount</p>
                            <p class="text-2xl font-extrabold text-purple-700">$<span x-text="results.investmentAmount?.toFixed(2)"></span></p>
                        </div>
                        <div class="bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-xl card-hover border-2 border-red-200">
                            <p class="text-xs text-red-700 font-bold uppercase tracking-wider mb-1">Risk Percentage</p>
                            <p class="text-2xl font-extrabold text-red-700"><span x-text="results.riskPercentage?.toFixed(2)"></span>%</p>
                        </div>
                        <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-4 rounded-xl card-hover border-2 border-orange-200">
                            <p class="text-xs text-orange-700 font-bold uppercase tracking-wider mb-1">Risk Amount</p>
                            <p class="text-2xl font-extrabold text-orange-700">$<span x-text="results.riskAmount?.toFixed(2)"></span></p>
                        </div>
                    </div>

                    <!-- Take Profit Results -->
                    <div x-show="results.tpGainPercentage !== null" class="mt-5">
                        <div class="flex items-center gap-2 mb-4">
                            <div class="h-6 w-1 bg-gradient-to-b from-green-500 to-emerald-600 rounded-full"></div>
                            <h3 class="text-xl font-extrabold text-gray-800">Take Profit Targets</h3>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                            <div class="bg-gradient-to-br from-green-50 to-emerald-100 p-4 rounded-xl card-hover border-2 border-green-200 relative group">
                                <button
                                    @click="copyToClipboard(takeProfit, 'TP1')"
                                    class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity p-1.5 bg-green-600 hover:bg-green-700 text-white rounded-lg z-10"
                                    title="Copy TP1 to clipboard"
                                >
                                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                    </svg>
                                </button>
                                <div class="flex items-center justify-between mb-2">
                                    <p class="text-xs text-green-700 font-bold uppercase tracking-wider">TP1</p>
                                    <span class="bg-green-500 text-white text-xs font-bold px-2 py-0.5 rounded-full">Target 1</span>
                                </div>
                                <p class="text-2xl font-extrabold text-green-700 mb-1">$<span x-text="takeProfit"></span></p>
                                <p class="text-xs text-green-600 font-semibold">Gain: <span x-text="results.tpGainPercentage?.toFixed(2)"></span>%</p>
                            </div>
                            <div class="bg-gradient-to-br from-green-50 to-emerald-100 p-4 rounded-xl card-hover border-2 border-green-200 relative group">
                                <button
                                    @click="copyToClipboard(results.tp2, 'TP2')"
                                    class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity p-1.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg z-10"
                                    title="Copy TP2 to clipboard"
                                >
                                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                    </svg>
                                </button>
                                <div class="flex items-center justify-between mb-2">
                                    <p class="text-xs text-green-700 font-bold uppercase tracking-wider">TP2 (2x)</p>
                                    <span class="bg-emerald-500 text-white text-xs font-bold px-2 py-0.5 rounded-full">Target 2</span>
                                </div>
                                <p class="text-2xl font-extrabold text-green-700 mb-1">$<span x-text="results.tp2"></span></p>
                                <p class="text-xs text-green-600 font-semibold">Gain: <span x-text="results.tp2GainPercentage?.toFixed(2)"></span>%</p>
                            </div>
                            <div class="bg-gradient-to-br from-green-50 to-emerald-100 p-4 rounded-xl card-hover border-2 border-green-200 relative group">
                                <button
                                    @click="copyToClipboard(results.tp3, 'TP3')"
                                    class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity p-1.5 bg-teal-600 hover:bg-teal-700 text-white rounded-lg z-10"
                                    title="Copy TP3 to clipboard"
                                >
                                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                    </svg>
                                </button>
                                <div class="flex items-center justify-between mb-2">
                                    <p class="text-xs text-green-700 font-bold uppercase tracking-wider">TP3 (3x)</p>
                                    <span class="bg-teal-500 text-white text-xs font-bold px-2 py-0.5 rounded-full">Target 3</span>
                                </div>
                                <p class="text-2xl font-extrabold text-green-700 mb-1">$<span x-text="results.tp3"></span></p>
                                <p class="text-xs text-green-600 font-semibold">Gain: <span x-text="results.tp3GainPercentage?.toFixed(2)"></span>%</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Success/Error Message -->
                <div x-show="errorMessage" class="mt-6 p-5 rounded-2xl animate-slide-in"
                     :class="errorMessage.startsWith('âœ“') ? 'bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-300' : 'bg-gradient-to-r from-red-50 to-pink-50 border-2 border-red-300'">
                    <div class="flex items-center gap-3">
                        <svg class="w-6 h-6" :class="errorMessage.startsWith('âœ“') ? 'text-green-600' : 'text-red-600'" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path x-show="!errorMessage.startsWith('âœ“')" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            <path x-show="errorMessage.startsWith('âœ“')" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <p class="font-bold" :class="errorMessage.startsWith('âœ“') ? 'text-green-700' : 'text-red-700'" x-text="errorMessage"></p>
                    </div>
                </div>
            </div>
        </main>

        <!-- SEO Content Section -->
        <article class="mt-8 glass-card rounded-2xl shadow-2xl p-6 md:p-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">About This Crypto Position Size Calculator</h2>
            <div class="text-gray-700 space-y-4">
                <p>
                    This free position size calculator is designed for cryptocurrency traders who want to manage their risk effectively. Whether you're trading Bitcoin, Ethereum, or any other crypto pair, this tool helps you calculate the exact position size based on your risk tolerance. Simply enter your current price and stop loss to get started.
                </p>
                <h3 class="text-xl font-bold text-gray-800 mt-4">How to Use the Position Size Calculator</h3>
                <p>
                    <strong>Risk Percentage Mode:</strong> Enter your total capital and the percentage you're willing to risk per trade. The calculator will determine how many coins to buy based on your stop loss level.
                </p>
                <p>
                    <strong>Capped Investment Mode:</strong> Set a maximum amount you want to invest per trade, and the calculator will show you the actual risk percentage and position size.
                </p>
                <p>
                    <strong>Manual Price Entry:</strong> If your trading pair isn't available in the Bybit price feed, simply enter the current price and stop loss manually to calculate your position size. This works for any exchange and any trading pair.
                </p>
                <h3 class="text-xl font-bold text-gray-800 mt-4">Key Features</h3>
                <ul class="list-disc list-inside space-y-2">
                    <li>Supports all crypto pairs (BTC, ETH, SOL, XRP, and more)</li>
                    <li>Optional Bybit price integration for quick calculations</li>
                    <li>Manual price entry for any trading pair</li>
                    <li>Stop loss and take profit calculations</li>
                    <li>Automatic TP2 and TP3 target generation (2x and 3x profit targets)</li>
                    <li>Professional risk management tools for cryptocurrency trading</li>
                    <li>Copy-to-clipboard functionality for quick order placement</li>
                    <li>Saves your preferences for future use</li>
                </ul>
                <h3 class="text-xl font-bold text-gray-800 mt-4">Why Position Sizing Matters</h3>
                <p>
                    Proper position sizing is crucial for long-term success in cryptocurrency trading. By calculating your position size based on your risk tolerance and stop loss levels, you can protect your capital and trade with confidence. This calculator helps you implement professional risk management strategies used by successful crypto traders for all crypto pairs.
                </p>
            </div>
        </article>

        <!-- Footer -->
        <footer class="mt-8 text-center text-white text-opacity-75 text-sm pb-4">
            <p>&copy; 2025 Crypto Position Size Calculator. Free tool for all crypto traders.</p>
            <p class="mt-2">Position sizing | Risk management | Crypto trading calculator | All crypto pairs</p>
        </footer>
    </div>

    <script>
        function positionCalculator() {
            return {
                // State
                loading: true,
                priceLoading: false,
                cryptoPairs: [],
                filteredPairs: [],
                searchQuery: '',
                dropdownOpen: false,
                selectedPair: '',
                totalCapital: 10000,
                calculationMode: 'risk', // 'risk' or 'capped'
                riskPercentage: 2,
                maxInvestment: 2500,
                currentPrice: null,
                stopLoss: null,
                takeProfit: null,
                errorMessage: '',
                results: {
                    coinsAmount: null,
                    investmentAmount: null,
                    riskPercentage: null,
                    riskAmount: null,
                    tpGainPercentage: null,
                    tpProfitAmount: null,
                    tp2: null,
                    tp2GainPercentage: null,
                    tp3: null,
                    tp3GainPercentage: null
                },

                // Initialize
                async init() {
                    // Load saved values from localStorage
                    const savedTotalCapital = localStorage.getItem('totalCapital');
                    const savedRiskPercentage = localStorage.getItem('riskPercentage');
                    const savedMaxInvestment = localStorage.getItem('maxInvestment');
                    const savedCalculationMode = localStorage.getItem('calculationMode');

                    if (savedTotalCapital) this.totalCapital = parseFloat(savedTotalCapital);
                    if (savedRiskPercentage) this.riskPercentage = parseFloat(savedRiskPercentage);
                    if (savedMaxInvestment) this.maxInvestment = parseFloat(savedMaxInvestment);
                    if (savedCalculationMode) this.calculationMode = savedCalculationMode;

                    await this.fetchCryptoPairs();
                },

                // Save values to localStorage
                saveToLocalStorage() {
                    localStorage.setItem('totalCapital', this.totalCapital);
                    localStorage.setItem('riskPercentage', this.riskPercentage);
                    localStorage.setItem('maxInvestment', this.maxInvestment);
                    localStorage.setItem('calculationMode', this.calculationMode);
                },

                // Fetch crypto pairs from Bybit
                async fetchCryptoPairs() {
                    this.loading = true;
                    this.errorMessage = '';

                    try {
                        const response = await fetch('https://api.bybit.com/v5/market/tickers?category=spot');
                        const data = await response.json();

                        if (data.retCode === 0 && data.result && data.result.list) {
                            // Filter USDT pairs and sort
                            this.cryptoPairs = data.result.list
                                .filter(item => item.symbol.endsWith('USDT'))
                                .map(item => item.symbol)
                                .sort();
                            this.filteredPairs = this.cryptoPairs;
                        } else {
                            this.errorMessage = 'Failed to load Bybit pairs (you can still enter price manually)';
                        }
                    } catch (error) {
                        console.error('Error fetching crypto pairs:', error);
                        this.errorMessage = 'Error loading Bybit pairs (you can still enter price manually)';
                    } finally {
                        this.loading = false;
                    }
                },

                // Fetch current price for selected pair
                async fetchCurrentPrice() {
                    if (!this.selectedPair) return;

                    this.priceLoading = true;
                    this.errorMessage = '';

                    try {
                        const response = await fetch(`https://api.bybit.com/v5/market/tickers?category=spot&symbol=${this.selectedPair}`);
                        const data = await response.json();

                        if (data.retCode === 0 && data.result && data.result.list && data.result.list.length > 0) {
                            this.currentPrice = parseFloat(data.result.list[0].lastPrice);
                            this.calculate();
                        } else {
                            this.errorMessage = 'Failed to fetch current price';
                        }
                    } catch (error) {
                        console.error('Error fetching price:', error);
                        this.errorMessage = 'Error fetching price from Bybit';
                    } finally {
                        this.priceLoading = false;
                    }
                },

                // Filter pairs based on search query
                filterPairs() {
                    if (!this.searchQuery) {
                        this.filteredPairs = this.cryptoPairs;
                    } else {
                        const query = this.searchQuery.toUpperCase();
                        this.filteredPairs = this.cryptoPairs.filter(pair =>
                            pair.toUpperCase().includes(query)
                        );
                    }
                },

                // Select a pair from dropdown
                selectPair(pair) {
                    this.selectedPair = pair;
                    this.searchQuery = pair;
                    this.dropdownOpen = false;
                    this.fetchCurrentPrice();
                },

                // Copy to clipboard
                copyToClipboard(text, label) {
                    navigator.clipboard.writeText(text).then(() => {
                        // Show temporary success message
                        const originalError = this.errorMessage;
                        this.errorMessage = `âœ“ ${label} copied to clipboard!`;
                        setTimeout(() => {
                            this.errorMessage = originalError;
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy:', err);
                        this.errorMessage = 'Failed to copy to clipboard';
                    });
                },

                // Calculate position size
                calculate() {
                    // Reset error
                    this.errorMessage = '';

                    // Validate inputs
                    if (!this.totalCapital || this.totalCapital <= 0) {
                        this.results.coinsAmount = null;
                        return;
                    }

                    if (!this.currentPrice || this.currentPrice <= 0) {
                        this.results.coinsAmount = null;
                        return;
                    }

                    if (!this.stopLoss || this.stopLoss <= 0) {
                        this.results.coinsAmount = null;
                        return;
                    }

                    // Stop loss must be less than current price
                    if (this.stopLoss >= this.currentPrice) {
                        this.errorMessage = 'Stop Loss must be less than Current Price';
                        this.results.coinsAmount = null;
                        return;
                    }

                    // Calculate risk per coin
                    const riskPerCoin = this.currentPrice - this.stopLoss;

                    if (this.calculationMode === 'risk') {
                        // Risk Percentage Mode
                        if (!this.riskPercentage || this.riskPercentage <= 0) {
                            this.results.coinsAmount = null;
                            return;
                        }

                        // Calculate risk amount in dollars
                        const riskAmount = (this.totalCapital * this.riskPercentage) / 100;

                        // Calculate number of coins
                        const coinsAmount = riskAmount / riskPerCoin;

                        // Calculate investment amount
                        const investmentAmount = coinsAmount * this.currentPrice;

                        // Store results
                        this.results.coinsAmount = coinsAmount;
                        this.results.investmentAmount = investmentAmount;
                        this.results.riskPercentage = this.riskPercentage;
                        this.results.riskAmount = riskAmount;

                    } else {
                        // Capped Investment Mode
                        if (!this.maxInvestment || this.maxInvestment <= 0) {
                            this.results.coinsAmount = null;
                            return;
                        }

                        // Calculate number of coins based on max investment
                        const coinsAmount = this.maxInvestment / this.currentPrice;

                        // Calculate risk amount
                        const riskAmount = coinsAmount * riskPerCoin;

                        // Calculate risk percentage
                        const riskPercentage = (riskAmount / this.totalCapital) * 100;

                        // Store results
                        this.results.coinsAmount = coinsAmount;
                        this.results.investmentAmount = this.maxInvestment;
                        this.results.riskPercentage = riskPercentage;
                        this.results.riskAmount = riskAmount;
                    }

                    // Calculate Take Profit if provided
                    if (this.takeProfit && this.takeProfit > this.currentPrice) {
                        const tpDistance = this.takeProfit - this.currentPrice;
                        const tpGainPercentage = (tpDistance / this.currentPrice) * 100;
                        const tpProfitAmount = this.results.coinsAmount * tpDistance;

                        // Calculate TP2 (2x distance)
                        const tp2 = this.currentPrice + (tpDistance * 2);
                        const tp2GainPercentage = ((tp2 - this.currentPrice) / this.currentPrice) * 100;

                        // Calculate TP3 (3x distance)
                        const tp3 = this.currentPrice + (tpDistance * 3);
                        const tp3GainPercentage = ((tp3 - this.currentPrice) / this.currentPrice) * 100;

                        this.results.tpGainPercentage = tpGainPercentage;
                        this.results.tpProfitAmount = tpProfitAmount;
                        this.results.tp2 = tp2;
                        this.results.tp2GainPercentage = tp2GainPercentage;
                        this.results.tp3 = tp3;
                        this.results.tp3GainPercentage = tp3GainPercentage;
                    } else {
                        // Reset TP results
                        this.results.tpGainPercentage = null;
                        this.results.tpProfitAmount = null;
                        this.results.tp2 = null;
                        this.results.tp2GainPercentage = null;
                        this.results.tp3 = null;
                        this.results.tp3GainPercentage = null;
                    }
                }
            }
        }
    </script>
</body>
</html>
